# v14 Radio-MambaNet: Simplified Single-Scale Configuration WITH CARS
# This configuration uses cars simulation and cars input channel

# Data Parameters
data:
  dataset_root_dir: '/mnt/mydisk/hgjia/data/RadioMapSeer'
  batch_size: 25
  num_workers: 4
  num_tx_per_map: 80
  cars_simul: 'yes'  # 'no' or 'yes' - use simulation with or without cars
  cars_input: 'yes'  # 'no' or 'yes' - include cars channel in input

# Model Configuration (Based on v12 medium scale)
Model:
  in_channels: 3
  out_channels: 1
  dims: [48, 96, 192, 384]
  depths: [2, 3, 4, 2]
  ssm_d_state: 32
  ssm_d_conv: 4
  ssm_expand: 2
  description: "Radio-MambaNet v14 with cars - 8.97M parameters - Simplified single configuration"

# Training Parameters
training:
  learning_rate: 0.0005
  weight_decay: 0.0001
  criterion: 'CombinedLossWithGradient'
  loss_weights:
    l1: 0.4
    mse: 0.1
    ssim: 0.2
    gradient: 0.3
  lr_scheduler_patience: 8
  early_stopping_patience: 14
  # Resume training from checkpoint (leave empty '' to start from scratch)
  resume_from_checkpoint: ''

# PyTorch Lightning Trainer Configuration
trainer_config:
  accelerator: 'gpu'
  devices: [5,6]
  precision: '16-mixed'
  max_steps: 100000
  log_every_n_steps: 220
  val_check_interval: 220

# Callbacks
callbacks:
  checkpoint_best:
    monitor: 'val_total_loss'
    dirpath: './checkpoints/withcars/'
    filename: 'best-radiomamba-withcars-{step}-{val_total_loss:.4f}'
    save_top_k: 1
    mode: 'min'
  checkpoint_latest:
    dirpath: './checkpoints/withcars/'
    filename: 'latest-radiomamba-withcars'
    every_n_train_steps: 220
    save_top_k: -1
  early_stopping:
    monitor: 'val_total_loss'
    patience: 14
    verbose: True
    mode: 'min'
  save_validation_images:
    save_dir: './logs/validation_images_withcars/'
    num_samples: 4
    log_to_tensorboard: True

# Logging
logging:
  tensorboard:
    save_dir: "./logs/tensorboard"
    name: "radiomap_mambanet_withcars"
    version: 1

# Other Parameters
seed: 42

# Testing Parameters
testing:
  checkpoint_path: './checkpoints/withcars/best-radiomamba-withcars-step=25520-val_total_loss=0.0156.ckpt'
  test_batch_size: 1
  num_test_samples: 8000
  num_save_images: 8000
  results_save_dir: './results/predictions_withcars/'
  metrics_filename: 'test_metrics_withcars.txt'
  save_individual_metrics: False

# Model Information
model_info:
  params: "8.97M"
  params_per_sample: 186.9
  description: "Radio-MambaNet v14 with cars - Simplified single-scale configuration"
  version: "v14" 